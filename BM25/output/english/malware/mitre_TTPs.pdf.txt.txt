 A user can manipulate access tokens 
to make a running process appear as though it is the child of a different process or belongs to 
someone other than the user that started the process. Additionally, an adversary that compromises a service provider or delegated administrator 
account may similarly be able to leverage a [Trusted 
Relationship](https://attack.mitre.org/techniques/T1199) to execute commands in connected 
virtual machines. In cloud environments, adversaries may leverage access to delete cloud storage objects, 
machine images, database instances, and other infrastructure crucial to operations to damage 
an organization or their customers. This may be done in order to extract monetary 
compensation from a victim in exchange for decryption or a decryption key (ransomware) or to 
render data permanently inaccessible in cases where the key is not saved or 
transmitted. (Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: 
US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018) 
 
In the case of ransomware, it is typical that common user files like Office documents, PDFs, 
images, videos, audio, text, and source code files will be encrypted (and often renamed and/or 
tagged with specific file markers). This may be achieved by using 
malware that shares a common algorithm with the infrastructure the adversary uses to receive 
the malware's communications. Guardrails ensure that a payload only executes against an intended target and 
reduces collateral damage from an adversary’s campaign. Examples include 
<code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and 
<code>locate</code>. <code>dir</code>, <code>show flash</code>, and/or 
<code>nvram</code>). For example, malware (particularly 
ransomware) may modify symbolic links and associated settings to enable access to files from 
local shortcuts with remote paths. Financial theft is the ultimate objective of 
several popular campaign types including extortion by ransomware,(Citation: FBI-ransomware) 
business email compromise (BEC) and fraud,(Citation: FBI-BEC) "pig butchering,"(Citation: 
wired-pig butchering) bank hacking,(Citation: DOJ-DPRK Heist) and exploiting cryptocurrency 
networks. (Citation: Sofacy Komplex Trojan)(Citation: Cybereason OSX Pirrit)(Citation: 
MalwareBytes ADS July 2015) 
 
Adversaries may also attempt to hide artifacts associated with malicious behavior by creating 
computing regions that are isolated from common security instrumentation, such as through the 
use of virtualization technology. Adversaries may send victims emails containing malicious attachments or links, typically to 
execute malicious code on victim systems. Adversaries may use the information from [Process 
Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape 
follow-on behaviors, including whether or not the adversary fully infects the target and/or 
attempts specific actions. Adversaries may use the information from [Query 
Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape 
follow-on behaviors, including whether or not the adversary fully infects the target and/or 
attempts specific actions. Stopping critical services or processes can inhibit or stop 
response to an incident or aid in the adversary's overall objectives to cause damage to the 
environment. (Citation: Mitiga Security Advisory: SSM Agent as Remote Access Trojan) 
 
Network infrastructure devices may also have configuration management tools that can be 
similarly abused by adversaries. Associated Tactics: TA0002, TA0008 
 
T1518: Software Discovery 
  Description: Adversaries may attempt to get a listing of software and software versions that are 
installed on a system or in a cloud environment. Adversaries may use the information from 
[Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to 
shape follow-on behaviors, including whether or not the adversary fully infects the target and/or 
attempts specific actions. Adversaries 
may use the information from [System Information 
Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape 
follow-on behaviors, including whether or not the adversary fully infects the target and/or 
attempts specific actions. Examples include [Arp](https://attack.mitre.org/software/S0099), 
[ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S01
01), [nbtstat](https://attack.mitre.org/software/S0102), and 
[route](https://attack.mitre.org/software/S0103). are present until after the malicious payload is 
fetched. Users may be subjected to social engineering to get them to execute malicious code by, for 
example, opening a malicious document file or link. For example, in 
AWS environments, an adversary who compromises a user’s AWS API credentials may be able 
to use the `sts:GetFederationToken` API call to create a federated user session, which will have 
the same permissions as the original user but may persist even if the original user credentials 
are deactivated. (Citation: Imperva DDoS for Hire)(Citation: Krebs-Anna)(Citation: Krebs-
Bazaar)(Citation: Krebs-Booter) 
  Parent Technique: T1583 
  Associated Tactics: TA0042 
 
T1584.005: Botnet 
  Description: Adversaries may compromise numerous third-party systems to form a botnet that 
can be used during targeting. A botnet is a network of compromised systems that can be 
instructed to perform coordinated tasks. (Citation: Norton Botnet) Instead of purchasing/renting a 
botnet from a booter/stresser service, adversaries may build their own botnet by compromising 
numerous third-party systems. CDNs may also allow organizations to customize content 
delivery based on the requestor’s geographical region. CMSTP.exe can also be abused to [Bypass User Account 
Control](https://attack.mitre.org/techniques/T1548/002) and execute arbitrary commands from a 
malicious INF through an auto-elevated COM interface. (Citation: demystifying_ryuk) 
 
Additionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to 
kernel space (i.e. Parent Technique: T1071 
  Associated Tactics: TA0011 
 
T1592.003: Firmware 
  Description: Adversaries may gather information about the victim's host firmware that can be 
used during targeting. On Linux and Mac, users can mark specific files as hidden simply by putting a “.” as the first 
character in the file or folder name  (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac 
Malware). (Citation: Sofacy Komplex Trojan)(Citation: Methods of Mac Malware 
Persistence) The Launch Agent name may be disguised by using a name from the related 
operating system or benign software. (Citation: Elastic 
CUBA Ransomware 2022)(Citation: Aquasec Kubernetes Attack 2023) They may also give 
accounts generic, trustworthy names, such as “admin”, “help”, or “root.”(Citation: Invictus IR 
Cloud Ransomware 2024) Sometimes adversaries may model account names off of those 
already existing in the system, as a follow-on behavior to [Account 
Discovery](https://attack.mitre.org/techniques/T1087). This may be done to evade some defenses, such as static indicator scanning tools and 
anti-virus. The PEB includes the process command-line arguments that are referenced when 
executing the process. When a process is created, defensive tools/sensors that monitor process 
creations may retrieve the process arguments from the PEB. At this point the process can be 
unmapped using APIs calls such as <code>ZwUnmapViewOfSection</code> or 
<code>NtUnmapViewOfSection</code>  before being written to, realigned to the injected code, 
and resumed via <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, 
<code>SetThreadContext</code>, then <code>ResumeThread</code> respectively. Parent Technique: T1592 
  Associated Tactics: TA0043 
 
T1027.002: Software Packing 
  Description: Adversaries may perform software packing or virtual machine software protection 
to conceal their code. (Citation: Systemd Remote Control) 
 
Each <code>.timer</code> file must have a corresponding <code>.service</code> file with the 
same name, e.g., <code>example.timer</code> and <code>example.service</code>. (Citation: Unit 42 Leaked Environment Variables 2024) 
 
In addition to incurring potential financial costs or availability disruptions, this technique may 
cause reputational damage if a victim’s bandwidth is used for illegal activities. Binary padding effectively changes the checksum of the file and can also be used to avoid 
hash-based blocklists and static anti-virus signatures. This creates a grandchild process with no parent 
process that is immediately adopted by the `init` system process (PID 1), which successfully 
disconnects the execution of the adversary's payload from its previous process tree. (Citation: Unit42 AcidBox June 2020)(Citation: GitHub 
Turla Driver Loader) 
  Associated Tactics: TA0005 
 
T1542.002: Component Firmware 
  Description: Adversaries may modify component firmware to persist on systems. Some 
adversaries may employ sophisticated means to compromise computer components and install 
malicious firmware that will execute adversary code outside of the operating system and main 
system firmware or BIOS. (Citation: Unit 
42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs) 
 
Additionally, some cryptocurrency mining malware identify then kill off processes for competing 
malware to ensure it’s not competing for resources. Adversaries may plant trojan 
dynamic-link library files (DLLs) in a directory that will be searched before the location of a 
legitimate library that will be requested by a program, causing Windows to load their malicious 
library when it is called for by the victim program. An adversary that compromises a user’s credentials may 
enroll a new device in order to bypass initial MFA requirements and gain persistent access to a 
network. A good example of this is when malware is detected with a file signature and quarantined by 
anti-virus software. An adversary who can determine that the malware was quarantined 
because of its file signature may modify the file to explicitly avoid that signature, and then re-use 
the malware. After the process is 
hijacked and malicious code is executed, the <code>KernelCallbackTable</code> may also be 
restored to its original state by the rest of the malicious payload. Associated Tactics: TA0002 
 
T1587.001: Malware 
  Description: Adversaries may develop malware and malware components that can be used 
during targeting. In addition to purchasing malware, adversaries may steal and 
repurpose malware from third-party entities (including other adversaries). This may 
include things such as cloud monitoring agents and anti-virus. Example commands that can be used to obtain security software information are 
[netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with 
[Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with 
[cmd](https://attack.mitre.org/software/S0106), and 
[Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior 
may be more specific to the type of software or security system the adversary is looking for. (Citation: Unit 42 OilRig Sept 2018) 
  Associated Tactics: TA0005, TA0007 
 
T1542.001: System Firmware 
  Description: Adversaries may modify system firmware to persist on systems.The BIOS (Basic 
Input/Output System) and The Unified Extensible Firmware Interface (UEFI) or Extensible 
Firmware Interface (EFI) are examples of system firmware that operate as the software 
interface between the operating system and hardware of a computer. Capabilities exist to overwrite 
the system firmware, which may give sophisticated adversaries a means to install malicious 
firmware updates as a means of persistence on a system that may be difficult to detect. This information may be used to 
shape follow-on behaviors, including whether the adversary infects the target and/or attempts 
specific actions. At this point the process can be suspended then written to, 
realigned to the injected code, and resumed via <code>SuspendThread </code>, 
<code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, 
<code>SetThreadContext</code>, then <code>ResumeThread</code> respectively. (Citation: 
Elastic Process Injection July 2017) 
 
This is very similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) but 
targets an existing process rather than creating a process in a suspended state. In addition to freely downloading or purchasing software, adversaries 
may steal software and/or software licenses from third-party entities (including other 
adversaries). Malicious software can include payloads, 
droppers, post-compromise tools, backdoors, and a variety of other malicious content. Associated Tactics: TA0002