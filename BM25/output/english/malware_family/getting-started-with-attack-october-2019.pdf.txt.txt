 You could repeat this for each of the  
software samples that we’ve mapped the group using, which we track separately on the  
ATT&CK website. For example, the malware in the above 
report “establishes a SOCKS5 connection.” The act of establishing a connection is a 
behavior the adversary took. | 12 | 
GETTING STARTED WITH ATT&CK: Detection and Analytics | John Wunder 
If you’ve installed Sigma and you’re in its directory you can run this command to get (as  
an example) the ELK/WinLogBeats query: 
sigmac --target es-qs -c tools/config/winlogbeat.yml rules/windows/process_ 
creation/win_susp_wmi_execution.yml 
RESULTS FROM RUNNING WMI ANALYTIC AGAINST BRAWL DATA  
Your job now is to look through each result and figure out whether it’s malicious. If  
you used the BRAWL dataset, it’s all pretty malicious: it tries to run and.exe, and upon  
further exploring the related events, and.exe had just been moved to that host over SMB  
and added to the autorun registry keys for persistence. Your goal shouldn’t be to get to zero false positives; it should  
be to reduce them as much as possible while still ensuring that you’ll catch the malicious  
behavior. For example, you can find their  
list of attacks for Regsvr32, including Squiblydoo. Of course, if you’re already doing red  
teaming, feel free to run the attacks you know yourself (on systems where you have  
permission!) and try to develop analytics for those! At this stage, you’re looking for things that make this malicious event look distinctive. I  
picked Squiblydoo as an example because it’s an easy one: there’s no legitimate reason  
to have regsvr32.exe call out to the Internet, so a simple analytic is to look for times when  
the regsvr32.exe process is created and the command line includes “/i:http”. A general pattern to follow is to write the search to detect malicious behavior, revise it to  
filter out false positives, make sure it still detects the malicious behavior, and then repeat  
to reduce other sorts of false positives. Test that confidence and improve your defenses by doing some purple  
teaming! It allows the operator to pick one technique or chain many together when  
building the test, which allows you to start to automate sequences of behaviors for your  
testing rather than manually executing single Atomic Tests. A good resource for getting started with event logs is Malware 
Archaeology’s Windows ATT&CK Logging Cheat Sheet, which maps Windows events to the 
techniques you could detect with them. ATT&CK SITE SEARCH FOR PORT 22 
Another important aspect to consider are the Group and Software examples listed  
along with a technique. As an example, you might not be able to install Sysmon on each  
of your endpoints, but your existing software might be able to forward relevant logs that  
you might not otherwise have access to. | 41 | 
|  Solving Problems for a Safer World